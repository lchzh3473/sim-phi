{"version":3,"file":"reader--eef626b8.js","sources":["../src/extends/pec/easing.js","../src/extends/pec/BpmList.ts","../src/extends/pec/LinePec.ts","../src/extends/pec/rpe2json.ts","../src/extends/pec/cubicBezier.js","../src/extends/pec/index.ts","../src/utils/reader-.ts","../src/extends/pec/pec2json.ts"],"sourcesContent":["/* eslint-disable no-param-reassign */\nconst tl = [\n  null, // 0\n  null, // 1\n  t => Math.sin(t * Math.PI / 2), // 2\n  t => 1 - Math.cos(t * Math.PI / 2), // 3\n  t => 1 - (t - 1) ** 2, // 4\n  t => t ** 2, // 5\n  t => (1 - Math.cos(t * Math.PI)) / 2, // 6\n  t => ((t *= 2) < 1 ? t ** 2 : -((t - 2) ** 2 - 2)) / 2, // 7\n  t => 1 + (t - 1) ** 3, // 8\n  t => t ** 3, // 9\n  t => 1 - (t - 1) ** 4, // 10\n  t => t ** 4, // 11\n  t => ((t *= 2) < 1 ? t ** 3 : (t - 2) ** 3 + 2) / 2, // 12\n  t => ((t *= 2) < 1 ? t ** 4 : -((t - 2) ** 4 - 2)) / 2, // 13\n  t => 1 + (t - 1) ** 5, // 14\n  t => t ** 5, // 15\n  t => 1 - 2 ** (-10 * t), // 16\n  t => 2 ** (10 * (t - 1)), // 17\n  t => Math.sqrt(1 - (t - 1) ** 2), // 18\n  t => 1 - Math.sqrt(1 - t ** 2), // 19\n  t => (2.70158 * t - 1) * (t - 1) ** 2 + 1, // 20\n  t => (2.70158 * t - 1.70158) * t ** 2, // 21\n  t => ((t *= 2) < 1 ? 1 - Math.sqrt(1 - t ** 2) : Math.sqrt(1 - (t - 2) ** 2) + 1) / 2, // 22\n  t => t < 0.5 ? (14.379638 * t - 5.189819) * t ** 2 : (14.379638 * t - 9.189819) * (t - 1) ** 2 + 1, // 23\n  t => 1 - 2 ** (-10 * t) * Math.cos(t * Math.PI / 0.15), // 24\n  t => 2 ** (10 * (t - 1)) * Math.cos((t - 1) * Math.PI / 0.15), // 25\n  t => ((t *= 11) < 4 ? t ** 2 : t < 8 ? (t - 6) ** 2 + 12 : t < 10 ? (t - 9) ** 2 + 15 : (t - 10.5) ** 2 + 15.75) / 16, // 26\n  t => 1 - tl[26](1 - t), // 27\n  t => (t *= 2) < 1 ? tl[26](t) / 2 : tl[27](t - 1) / 2 + 0.5, // 28\n  t => t < 0.5 ? 2 ** (20 * t - 11) * Math.sin((160 * t + 1) * Math.PI / 18) : 1 - 2 ** (9 - 20 * t) * Math.sin((160 * t + 1) * Math.PI / 18) // 29\n];\nfunction isLinear(index) {\n  index = Math.trunc(index);\n  return index < 2 || index > 29;\n}\n/**\n * @param {number} index\n * @returns {((t: number) => number) | null}\n */\nfunction easing(index) {\n  index = Math.trunc(index);\n  return tl[index];\n}\nexport { isLinear, easing };\n","interface BpmEventPec {\n  start: number;\n  end: number;\n  bpm: number;\n  value: number;\n}\nexport type BeatArray = [number, number, number];\nexport class BpmList {\n  public baseBpm: number;\n  private accTime: number;\n  private readonly list: BpmEventPec[];\n  public constructor(baseBpm: unknown) {\n    this.baseBpm = Number(baseBpm) || 120;\n    this.accTime = 0;\n    this.list = []; // 存放bpm变速事件\n  }\n  public push(start: number, end: number, bpm: number): void {\n    const value = this.accTime;\n    this.list.push({ start, end, bpm, value });\n    this.accTime += (end - start) / bpm;\n  }\n  public calc(beat: number): number {\n    let time = 0;\n    for (const i of this.list) {\n      if (beat > i.end) continue;\n      if (beat < i.start) break;\n      time = Math.round(((beat - i.start) / i.bpm + i.value) * this.baseBpm * 32);\n    }\n    return time;\n  }\n  public calc2(time: BeatArray): number {\n    return this.calc(time[0] + time[1] / time[2]);\n  }\n}\n","import { easing } from './easing.js';\ninterface SpeedEventPec {\n  time: number;\n  value: number;\n}\ninterface NotePecExtends {\n  type: number;\n  time: number;\n  positionX: number;\n  holdTime: number;\n  speed: number;\n  isAbove: boolean;\n  isFake: boolean;\n}\ninterface LineEventPec {\n  startTime: number;\n  endTime: number;\n  value: number;\n  motionType: number;\n}\ninterface LineEventPecExtends extends LineEventPec {\n  value2: number;\n}\nexport class LinePec {\n  private readonly bpm: number;\n  private readonly speedEvents: SpeedEventPec[];\n  private readonly notes: NotePecExtends[];\n  private readonly alphaEvents: LineEventPec[];\n  private readonly moveEvents: LineEventPecExtends[];\n  private readonly rotateEvents: LineEventPec[];\n  public constructor(bpm: number) {\n    this.bpm = 120;\n    this.speedEvents = [];\n    this.notes = [];\n    this.alphaEvents = [];\n    this.moveEvents = [];\n    this.rotateEvents = [];\n    if (!isNaN(bpm)) { this.bpm = bpm }\n  }\n  public pushNote(type: number, time: number, positionX: number, holdTime: number, speed: number, isAbove: boolean, isFake: boolean): void {\n    this.notes.push({ type, time, positionX, holdTime, speed, isAbove, isFake });\n  }\n  public pushSpeedEvent(time: number, value: number): void {\n    this.speedEvents.push({ time, value });\n  }\n  public pushAlphaEvent(startTime: number, endTime: number, value: number, motionType: number): void {\n    this.alphaEvents.push({ startTime, endTime, value, motionType });\n  }\n  public pushMoveEvent(startTime: number, endTime: number, value: number, value2: number, motionType: number): void {\n    this.moveEvents.push({ startTime, endTime, value, value2, motionType });\n  }\n  public pushRotateEvent(startTime: number, endTime: number, value: number, motionType: number): void {\n    this.rotateEvents.push({ startTime, endTime, value, motionType });\n  }\n  public format(): JudgeLine {\n    const sortFn = (a: { time: number }, b: { time: number }) => a.time - b.time;\n    const sortFn2 = (a: { startTime: number; endTime: number }, b: { startTime: number; endTime: number }) => a.startTime - b.startTime + (a.endTime - b.endTime);\n    // 不单独判断以避免误差\n    const result = {\n      formatVersion: 3,\n      offset: 0,\n      bpm: this.bpm,\n      speedEvents: [] as SpeedEvent[],\n      numOfNotes: 0,\n      numOfNotesAbove: 0,\n      numOfNotesBelow: 0,\n      notesAbove: [] as Note[],\n      notesBelow: [] as Note[],\n      judgeLineDisappearEvents: [] as JudgeLineEvent[],\n      judgeLineMoveEvents: [] as JudgeLineEvent[],\n      judgeLineRotateEvents: [] as JudgeLineEvent[]\n    };\n    const pushDisappearEvent = (startTime: number, endTime: number, start: number, end: number) => {\n      result.judgeLineDisappearEvents.push({ startTime, endTime, start, end, start2: 0, end2: 0 });\n    };\n    const pushMoveEvent = (startTime: number, endTime: number, start: number, end: number, start2: number, end2: number) => {\n      result.judgeLineMoveEvents.push({ startTime, endTime, start, end, start2, end2 });\n    };\n    const pushRotateEvent = (startTime: number, endTime: number, start: number, end: number) => {\n      result.judgeLineRotateEvents.push({ startTime, endTime, start, end, start2: 0, end2: 0 });\n    };\n    // cv和floorPosition一并处理\n    const cvp = this.speedEvents.sort(sortFn);\n    let s1 = 0;\n    for (let i = 0; i < cvp.length; i++) {\n      const startTime = Math.max(cvp[i].time, 0);\n      const endTime = i < cvp.length - 1 ? cvp[i + 1].time : 1e9;\n      const { value } = cvp[i];\n      const floorPosition = s1;\n      s1 += (endTime - startTime) * value / this.bpm * 1.875;\n      s1 = Math.fround(s1);\n      result.speedEvents.push({ startTime, endTime, value, floorPosition });\n    }\n    for (const i of this.notes.sort(sortFn)) {\n      const { time } = i;\n      let v1 = 0;\n      let v2 = 0;\n      let v3 = 0;\n      for (const e of result.speedEvents) {\n        if (time > e.endTime) { continue }\n        if (time < e.startTime) { break }\n        v1 = e.floorPosition;\n        v2 = e.value;\n        v3 = time - e.startTime;\n      }\n      const note = {\n        type: i.type,\n        time: time + (i.isFake ? 1e9 : 0),\n        positionX: i.positionX,\n        holdTime: i.holdTime,\n        speed: i.speed * (i.type === 3 ? v2 : 1),\n        floorPosition: Math.fround(v1 + v2 * v3 / this.bpm * 1.875)\n      };\n      if (i.isAbove) {\n        result.notesAbove.push(note);\n        if (i.isFake) { continue }\n        result.numOfNotes++;\n        result.numOfNotesAbove++;\n      } else {\n        result.notesBelow.push(note);\n        if (i.isFake) { continue }\n        result.numOfNotes++;\n        result.numOfNotesBelow++;\n      }\n    }\n    // 整合motionType\n    let dt = 0;\n    let d1 = 0;\n    for (const e of this.alphaEvents.sort(sortFn2)) {\n      pushDisappearEvent(dt, e.startTime, d1, d1);\n      const easingFn = easing(e.motionType);\n      if (easingFn != null) {\n        const t1 = e.value - d1;\n        let x1 = 0;\n        let x2 = 0;\n        for (let i = e.startTime; i < e.endTime; i++) {\n          x1 = x2;\n          x2 = easingFn((i + 1 - e.startTime) / (e.endTime - e.startTime));\n          pushDisappearEvent(i, i + 1, d1 + x1 * t1, d1 + x2 * t1);\n        }\n      } else if (e.motionType) pushDisappearEvent(e.startTime, e.endTime, d1, e.value);\n      dt = e.endTime;\n      d1 = e.value;\n    }\n    pushDisappearEvent(dt, 1e9, d1, d1);\n    //\n    let mt = 0;\n    let m1 = 0;\n    let m2 = 0;\n    for (const e of this.moveEvents.sort(sortFn2)) {\n      pushMoveEvent(mt, e.startTime, m1, m1, m2, m2);\n      const easingFn = easing(e.motionType);\n      if (easingFn != null) {\n        const t1 = e.value - m1;\n        const t2 = e.value2 - m2;\n        let x1 = 0;\n        let x2 = 0;\n        for (let i = e.startTime; i < e.endTime; i++) {\n          x1 = x2;\n          x2 = easingFn((i + 1 - e.startTime) / (e.endTime - e.startTime));\n          pushMoveEvent(i, i + 1, m1 + x1 * t1, m1 + x2 * t1, m2 + x1 * t2, m2 + x2 * t2);\n        }\n      } else if (e.motionType === 1) pushMoveEvent(e.startTime, e.endTime, m1, e.value, m2, e.value2);\n      mt = e.endTime;\n      m1 = e.value;\n      m2 = e.value2;\n    }\n    pushMoveEvent(mt, 1e9, m1, m1, m2, m2);\n    //\n    let rt = 0;\n    let r1 = 0;\n    for (const e of this.rotateEvents.sort(sortFn2)) {\n      pushRotateEvent(rt, e.startTime, r1, r1);\n      const easingFn = easing(e.motionType);\n      if (easingFn != null) {\n        const t1 = e.value - r1;\n        let x1 = 0;\n        let x2 = 0;\n        for (let i = e.startTime; i < e.endTime; i++) {\n          x1 = x2;\n          x2 = easingFn((i + 1 - e.startTime) / (e.endTime - e.startTime));\n          pushRotateEvent(i, i + 1, r1 + x1 * t1, r1 + x2 * t1);\n        }\n      } else if (e.motionType === 1) pushRotateEvent(e.startTime, e.endTime, r1, e.value);\n      rt = e.endTime;\n      r1 = e.value;\n    }\n    pushRotateEvent(rt, 1e9, r1, r1);\n    return result;\n  }\n}\n","/* eslint-disable @typescript-eslint/naming-convention */\nimport { type BeatArray, BpmList } from './BpmList';\nimport { easing } from './easing.js';\nimport { cubicBezier } from './cubicBezier.js';\ninterface BpmEventRPE {\n  startTime: BeatArray;\n  bpm: number;\n}\ninterface BpmEventRPEExtends extends BpmEventRPE {\n  time: number;\n}\ninterface LineEventPec {\n  startTime: number;\n  endTime: number;\n  start: number;\n  end: number;\n}\ninterface LineEventPec2 extends LineEventPec {\n  start2: number;\n  end2: number;\n}\ninterface LineEventPecDelta extends LineEventPec {\n  delta: number;\n}\ninterface SpeedEventPec {\n  time: number;\n  value: number;\n}\ninterface LineEventRPE {\n  startTime: BeatArray;\n  endTime: BeatArray;\n  start: number;\n  end: number;\n  easingType: number;\n  linkgroup?: number;\n  easingLeft?: number;\n  easingRight?: number;\n  bezier?: number;\n  bezierPoints?: [number, number, number, number];\n}\ninterface LineEventRPE2 {\n  startTime: number;\n  endTime: number;\n  start: number;\n  end: number;\n  easingFn?: (t: number) => number;\n}\nconst enum EasingCode {\n  NoError = 0,\n  EqualsLinear = 1,\n  LeftEqualsRight = -1,\n  TypeNotSupported = -2,\n  ValueNotFinite = -3\n}\ninterface EasingResult {\n  code: EasingCode;\n  fn?: (t: number) => number;\n}\nfunction getEasingFn(le: LineEventRPE, startTime: number, endTime: number): EasingResult {\n  const { start, end, bezier = 0 } = le;\n  if (Math.floor(bezier) === 1) return bezierFn();\n  return clipFn();\n  function clipFn() {\n    const { easingType, easingLeft = 0, easingRight = 1 } = le;\n    if (easingLeft === easingRight) return { code: EasingCode.LeftEqualsRight };\n    if (start === end) return { code: EasingCode.EqualsLinear };\n    const easingFn = easing(easingType);\n    if (easingFn == null) return { code: easingType === 1 ? EasingCode.EqualsLinear : EasingCode.TypeNotSupported };\n    const eHead = easingFn(easingLeft);\n    const eTail = easingFn(easingRight);\n    const eSpeed = (easingRight - easingLeft) / (endTime - startTime);\n    const e1Delta = (end - start) / (eTail - eHead);\n    if (!isFinite(e1Delta)) return { code: EasingCode.ValueNotFinite };\n    return { code: EasingCode.NoError, fn: (t: number) => (easingFn((t - startTime) * eSpeed + easingLeft) - eHead) * e1Delta };\n  }\n  function bezierFn() {\n    if (start === end) return { code: EasingCode.EqualsLinear };\n    const { bezierPoints: [p1x, p1y, p2x, p2y] = [0, 0, 0, 0] } = le;\n    if (p1x === p1y && p2x === p2y) return { code: EasingCode.EqualsLinear };\n    const eSpeed = 1 / (endTime - startTime);\n    const e1Delta = end - start;\n    const easingFn = cubicBezier(p1x, p1y, p2x, p2y);\n    return { code: EasingCode.NoError, fn: (t: number) => easingFn((t - startTime) * eSpeed) * e1Delta };\n  }\n}\nfunction pushLineEvent(ls: LineEventPecDelta[], le: LineEventRPE2) {\n  const { startTime, endTime, start, end, easingFn } = le;\n  const delta = (end - start) / (endTime - startTime);\n  // 插入之前考虑事件时间的相互关系\n  for (let i = ls.length - 1; i >= 0; i--) {\n    const e = ls[i];\n    if (e.endTime < startTime) { // 相离：补全空隙\n      ls[i + 1] = { startTime: e.endTime, endTime: startTime, start: e.end, end: e.end, delta: 0 };\n      break;\n    }\n    if (e.startTime === startTime) { // 相切：直接截断\n      ls.length = i;\n      break;\n    }\n    if (e.startTime < startTime) { // 相交：截断交点以后的部分\n      e.end = e.start + (startTime - e.startTime) * e.delta;\n      e.endTime = startTime;\n      e.delta = (e.end - e.start) / (startTime - e.startTime);\n      ls.length = i + 1;\n      break;\n    }\n  }\n  // 插入新事件\n  if (startTime >= endTime) {\n    ls.push({ startTime, endTime: startTime, start: end, end, delta: 0 });\n    return;\n  }\n  if (easingFn == null) {\n    ls.push({ startTime, endTime, start, end, delta });\n  } else {\n    let v1 = 0;\n    let v2 = 0;\n    for (let j = startTime; j < endTime; j++) {\n      v1 = v2;\n      v2 = easingFn(j + 1);\n      ls.push({ startTime: j, endTime: j + 1, start: start + v1, end: start + v2, delta: v2 - v1 });\n    }\n  }\n}\nfunction toSpeedEvent(le: LineEventRPE2[]) {\n  const result = [];\n  for (const i of le) {\n    const { startTime, endTime, start, end } = i;\n    result.push({ time: startTime, value: start });\n    if (start !== end) { // 暂未考虑开始时间大于结束时间的情况\n      const t1 = (end - start) / (endTime - startTime);\n      for (let j = startTime; j < endTime; j++) {\n        const x = j + 0.5 - startTime;\n        result.push({ time: j, value: start + x * t1 });\n      }\n      result.push({ time: endTime, value: end });\n    }\n  }\n  return result;\n}\nfunction getEventsValue(e: LineEventPecDelta[], t: number, d: boolean) {\n  let result = e[0]?.start ?? 0;\n  for (const i of e) {\n    const { startTime, endTime, start, end, delta } = i;\n    if (t < startTime) break;\n    if (d && t === startTime) break;\n    if (t >= endTime) result = end;\n    else result = start + (t - startTime) * delta;\n  }\n  return result;\n}\nfunction getMoveValue(e: LineEventPec2[], t: number, d: boolean) {\n  let result = e[0]?.start ?? 0;\n  let result2 = e[0]?.start2 ?? 0;\n  for (const i of e) {\n    const { startTime, endTime, start, end, start2, end2 } = i;\n    if (t < startTime) break;\n    if (d && t === startTime) break;\n    if (t >= endTime) {\n      result = end;\n      result2 = end2;\n    } else {\n      result = start + (t - startTime) * (end - start) / (endTime - startTime);\n      result2 = start2 + (t - startTime) * (end2 - start2) / (endTime - startTime);\n    }\n  }\n  return [result, result2];\n}\nfunction getRotateValue(e: LineEventRPE2[], t: number, d: boolean) {\n  let result = e[0]?.start ?? 0;\n  for (const i of e) {\n    const { startTime, endTime, start, end } = i;\n    if (t < startTime) break;\n    if (d && t === startTime) break;\n    if (t >= endTime) result = end;\n    else { result = start + (t - startTime) * (end - start) / (endTime - startTime) }\n  }\n  return result;\n}\nfunction combineXYEvents(xe: LineEventPecDelta[], ye: LineEventPecDelta[]) {\n  const le = [];\n  const splits = [];\n  for (const i of xe) splits.push(i.startTime, i.endTime);\n  for (const i of ye) splits.push(i.startTime, i.endTime);\n  splits.sort((a, b) => a - b);\n  for (let i = 0; i < splits.length - 1; i++) {\n    const startTime = splits[i];\n    const endTime = splits[i + 1];\n    if (startTime === endTime) continue;\n    const startX = getEventsValue(xe, startTime, false);\n    const endX = getEventsValue(xe, endTime, true);\n    const startY = getEventsValue(ye, startTime, false);\n    const endY = getEventsValue(ye, endTime, true);\n    le.push({ startTime, endTime, start: startX, end: endX, start2: startY, end2: endY });\n  }\n  return le;\n}\nfunction combineMultiEvents(es: LineEventPecDelta[][]) {\n  const le = [];\n  const splits = [];\n  for (const e of es) {\n    for (const i of e) splits.push(i.startTime, i.endTime);\n  }\n  splits.sort((a, b) => a - b);\n  for (let i = 0; i < splits.length - 1; i++) {\n    const startTime = splits[i];\n    const endTime = splits[i + 1];\n    if (startTime === endTime) continue;\n    const start = es.reduce((n, e) => n + getEventsValue(e, startTime, false), 0);\n    const end = es.reduce((n, e) => n + getEventsValue(e, endTime, true), 0);\n    le.push({ startTime, endTime, start, end, delta: (end - start) / (endTime - startTime) });\n  }\n  return le;\n}\nfunction mergeFather(child: LineRPE1, father: LineRPE1) {\n  const moveEvents = [];\n  const splits = [];\n  for (const i of father.moveEvents!) splits.push(i.startTime, i.endTime);\n  for (const i of father.rotateEvents!) splits.push(i.startTime, i.endTime);\n  for (const i of child.moveEvents!) splits.push(i.startTime, i.endTime);\n  splits.sort((a, b) => a - b);\n  for (let i = splits[0]; i < splits[splits.length - 1]; i++) {\n    const startTime = i;\n    const endTime = i + 1;\n    if (startTime === endTime) continue;\n    // 计算父级移动和旋转\n    const [fatherX, fatherY] = getMoveValue(father.moveEvents!, startTime, false);\n    const fatherR = getRotateValue(father.rotateEvents!, startTime, false) * -Math.PI / 180;\n    const [fatherX2, fatherY2] = getMoveValue(father.moveEvents!, endTime, true);\n    const fatherR2 = getRotateValue(father.rotateEvents!, endTime, true) * -Math.PI / 180;\n    // 计算子级移动\n    const [childX, childY] = getMoveValue(child.moveEvents!, startTime, false);\n    const [childX2, childY2] = getMoveValue(child.moveEvents!, endTime, true);\n    // 坐标转换\n    const start = fatherX + childX * Math.cos(fatherR) - childY * Math.sin(fatherR);\n    const end = fatherX2 + childX2 * Math.cos(fatherR2) - childY2 * Math.sin(fatherR2);\n    const start2 = fatherY + childX * Math.sin(fatherR) + childY * Math.cos(fatherR);\n    const end2 = fatherY2 + childX2 * Math.sin(fatherR2) + childY2 * Math.cos(fatherR2);\n    moveEvents.push({ startTime, endTime, start, end, start2, end2 });\n  }\n  child.moveEvents = moveEvents;\n}\ninterface EventLayer {\n  moveXEvents: LineEventRPE[];\n  moveYEvents: LineEventRPE[];\n  rotateEvents: LineEventRPE[];\n  alphaEvents: LineEventRPE[];\n  speedEvents: LineEventRPE[];\n}\nclass EventLayer1 {\n  public moveXEvents: LineEventRPE2[];\n  public moveYEvents: LineEventRPE2[];\n  public rotateEvents: LineEventRPE2[];\n  public alphaEvents: LineEventRPE2[];\n  public speedEvents: LineEventRPE2[];\n  public constructor() {\n    this.moveXEvents = [];\n    this.moveYEvents = [];\n    this.rotateEvents = [];\n    this.alphaEvents = [];\n    this.speedEvents = [];\n  }\n  public pushMoveXEvent(startTime: number, endTime: number, start: number, end: number, easingFn?: (t: number) => number) {\n    this.moveXEvents.push({ startTime, endTime, start, end, easingFn });\n  }\n  public pushMoveYEvent(startTime: number, endTime: number, start: number, end: number, easingFn?: (t: number) => number) {\n    this.moveYEvents.push({ startTime, endTime, start, end, easingFn });\n  }\n  public pushRotateEvent(startTime: number, endTime: number, start: number, end: number, easingFn?: (t: number) => number) {\n    this.rotateEvents.push({ startTime, endTime, start, end, easingFn });\n  }\n  public pushAlphaEvent(startTime: number, endTime: number, start: number, end: number, easingFn?: (t: number) => number) {\n    this.alphaEvents.push({ startTime, endTime, start, end, easingFn });\n  }\n  public pushSpeedEvent(startTime: number, endTime: number, start: number, end: number) { this.speedEvents.push({ startTime, endTime, start, end }) }\n}\ninterface NoteRPE {\n  type: number;\n  startTime: BeatArray;\n  endTime: BeatArray;\n  positionX: number;\n  above: number;\n  isFake: number;\n  speed: number;\n  size: number;\n  yOffset: number;\n  visibleTime: number;\n  alpha: number;\n}\ninterface NoteRPE1 {\n  type: number;\n  time: number;\n  positionX: number;\n  holdTime: number;\n  speed: number;\n  isAbove: boolean;\n  isFake: boolean;\n  isHidden: boolean;\n}\nclass LineRPE1 {\n  public bpm: number;\n  public notes: NoteRPE1[];\n  public eventLayers: EventLayer1[];\n  public id?: number;\n  public father: LineRPE1 | null;\n  public moveEvents?: LineEventPec2[];\n  public rotateEvents?: LineEventPec[];\n  public alphaEvents?: LineEventPec[];\n  public speedEvents?: SpeedEventPec[];\n  private settled: boolean;\n  private merged: boolean;\n  public constructor(bpm: number) {\n    this.bpm = 120;\n    this.notes = [];\n    this.eventLayers = [];\n    this.father = null;\n    this.settled = false;\n    this.merged = false;\n    if (!isNaN(bpm)) this.bpm = bpm;\n  }\n  public pushNote(type: number, time: number, positionX: number, holdTime: number, speed: number, isAbove: boolean, isFake: boolean, isHide: boolean) {\n    this.notes.push({ type, time, positionX, holdTime, speed, isAbove, isFake, isHidden: isHide });\n  }\n  public setId(id = NaN) { this.id = id }\n  public setFather(fatherLine: LineRPE1 | null) { this.father = fatherLine }\n  public preset() {\n    const sortFn2 = (a: { startTime: number }, b: { startTime: number }) => a.startTime - b.startTime;\n    const events = [];\n    for (const e of this.eventLayers) {\n      const moveXEvents: LineEventPecDelta[] = [];\n      const moveYEvents: LineEventPecDelta[] = [];\n      const rotateEvents: LineEventPecDelta[] = [];\n      const alphaEvents: LineEventPecDelta[] = [];\n      const speedEvents: LineEventPecDelta[] = [];\n      for (const i of e.moveXEvents.sort(sortFn2)) pushLineEvent(moveXEvents, i);\n      for (const i of e.moveYEvents.sort(sortFn2)) pushLineEvent(moveYEvents, i);\n      for (const i of e.rotateEvents.sort(sortFn2)) pushLineEvent(rotateEvents, i);\n      for (const i of e.alphaEvents.sort(sortFn2)) pushLineEvent(alphaEvents, i);\n      for (const i of e.speedEvents.sort(sortFn2)) pushLineEvent(speedEvents, i); // TODO: 特殊处理\n      events.push({ moveXEvents, moveYEvents, rotateEvents, alphaEvents, speedEvents });\n    }\n    const moveXEvents = combineMultiEvents(events.map(i => i.moveXEvents));\n    const moveYEvents = combineMultiEvents(events.map(i => i.moveYEvents));\n    this.moveEvents = combineXYEvents(moveXEvents, moveYEvents);\n    this.rotateEvents = combineMultiEvents(events.map(i => i.rotateEvents));\n    this.alphaEvents = combineMultiEvents(events.map(i => i.alphaEvents));\n    this.speedEvents = toSpeedEvent(combineMultiEvents(events.map(i => i.speedEvents)));\n    this.settled = true;\n  }\n  public fitFather(stack: LineRPE1[] = [], onwarning = console.warn) {\n    if (!this.settled) this.preset();\n    if (stack.includes(this)) {\n      onwarning(`检测到循环继承：${stack.concat(this).map(i => i.id).join('->')}(对应的father将被视为-1)`);\n      stack.map(i => i.setFather(null));\n      return;\n    }\n    if (this.father) this.father.fitFather(stack.concat(this), onwarning);\n    // this.father可能会在上一行被修改成null\n    if (this.father && !this.merged) {\n      mergeFather(this, this.father);\n      this.merged = true;\n    }\n  }\n  public format({ onwarning = console.warn } = {}) {\n    this.fitFather([], onwarning);\n    const result = {\n      bpm: this.bpm,\n      speedEvents: [] as SpeedEvent[],\n      numOfNotes: 0,\n      numOfNotesAbove: 0,\n      numOfNotesBelow: 0,\n      notesAbove: [] as Note[],\n      notesBelow: [] as Note[],\n      judgeLineDisappearEvents: [] as JudgeLineEvent[],\n      judgeLineMoveEvents: [] as JudgeLineEvent[],\n      judgeLineRotateEvents: [] as JudgeLineEvent[]\n    };\n    for (const i of this.moveEvents!) {\n      result.judgeLineMoveEvents.push({\n        startTime: i.startTime,\n        endTime: i.endTime,\n        start: (i.start + 675) / 1350,\n        end: (i.end + 675) / 1350,\n        start2: (i.start2 + 450) / 900,\n        end2: (i.end2 + 450) / 900\n      });\n    }\n    for (const i of this.rotateEvents!) {\n      result.judgeLineRotateEvents.push({\n        startTime: i.startTime,\n        endTime: i.endTime,\n        start: -i.start,\n        end: -i.end,\n        start2: 0,\n        end2: 0\n      });\n    }\n    for (const i of this.alphaEvents!) {\n      result.judgeLineDisappearEvents.push({\n        startTime: i.startTime,\n        endTime: i.endTime,\n        start: Math.max(0, i.start / 255),\n        end: Math.max(0, i.end / 255),\n        start2: 0,\n        end2: 0\n      });\n    }\n    // 添加floorPosition\n    let floorPos = 0;\n    let minPos = 0;\n    const speedEvents = this.speedEvents!;\n    for (let i = 0; i < speedEvents.length; i++) {\n      const startTime = Math.max(speedEvents[i].time, 0);\n      const endTime = i < speedEvents.length - 1 ? speedEvents[i + 1].time : 1e9;\n      const value = speedEvents[i].value * 2 / 9;\n      result.speedEvents.push({ startTime, endTime, value, floorPosition: floorPos, floorPositionMin: minPos });\n      floorPos += (endTime - startTime) * value / this.bpm * 1.875;\n      floorPos = Math.fround(floorPos);\n      minPos = Math.min(minPos, floorPos);\n    }\n    // 处理notes\n    const sortFn = (a: { time: number }, b: { time: number }) => a.time - b.time;\n    const getPositionValues = (time: number) => {\n      let v1 = 0;\n      let v2 = 0;\n      let v3 = 0;\n      let vmin = 0;\n      for (const e of result.speedEvents) {\n        if (time > e.endTime) continue;\n        if (time < e.startTime) break;\n        v1 = e.floorPosition;\n        v2 = e.value;\n        v3 = time - e.startTime;\n        vmin = e.floorPositionMin!;\n      }\n      return { v1, v4: v2 * v3, vmin };\n    };\n    const getHoldSpeedValue = (time: number, holdTime: number) => {\n      const start = getPositionValues(time);\n      const end = getPositionValues(time + holdTime);\n      return ((end.v1 - start.v1) / 1.875 * this.bpm + (end.v4 - start.v4)) / holdTime;\n    };\n    for (const i of this.notes.sort(sortFn)) {\n      const { v1, v4, vmin } = getPositionValues(i.time);\n      const speedFactor = i.type === 3 ? getHoldSpeedValue(i.time, i.holdTime) : 1;\n      const floorPosition = Math.fround(v1 + v4 / this.bpm * 1.875);\n      const note = {\n        type: i.type,\n        time: i.time + (i.isFake ? 1e9 : 0),\n        positionX: i.positionX,\n        holdTime: i.holdTime,\n        speed: i.speed * speedFactor,\n        floorPosition\n      };\n      if (i.isHidden) {\n        note.speed = 0;\n        note.floorPosition = Math.min(vmin, floorPosition) - 1;\n      }\n      if (i.isAbove) {\n        result.notesAbove.push(note);\n        if (i.isFake) continue;\n        result.numOfNotes++;\n        result.numOfNotesAbove++;\n      } else {\n        result.notesBelow.push(note);\n        if (i.isFake) continue;\n        result.numOfNotes++;\n        result.numOfNotesBelow++;\n      }\n    }\n    return result;\n  }\n}\ninterface RPEMeta {\n  RPEVersion: string;\n  song: string;\n  background: string;\n  name: string;\n  composer: string;\n  charter: string;\n  level: string;\n  offset: number;\n}\ninterface RPEDataBase {\n  BPMList: BpmEventRPEExtends[];\n  judgeLineList: JudgeLineRPEExtends[];\n}\ntype RPEDataLegacy = RPEDataBase & RPEMeta & { META: undefined };\ntype RPEDataCurrent = RPEDataBase & { META: RPEMeta };\ntype RPEData = RPEDataCurrent | RPEDataLegacy;\ninterface JudgeLineRPE {\n  numOfNotes: number;\n  isCover: number;\n  Texture: string;\n  eventLayers: (EventLayer | null)[];\n  extended?: {\n    scaleXEvents: LineEventRPE[];\n    scaleYEvents: LineEventRPE[];\n  } | null;\n  notes: NoteRPE[] | null;\n  Group: number;\n  Name: string;\n  zOrder: number;\n  bpmfactor: number;\n  father: number;\n}\ninterface JudgeLineRPEExtends extends JudgeLineRPE {\n  LineId: number;\n  judgeLineRPE: LineRPE1;\n}\nexport function parse(pec: string, filename: string): {\n  data: string;\n  messages: BetterMessage[];\n  info: Record<string, string>;\n  line: Record<string, string>[];\n  format: string;\n} {\n  const data = JSON.parse(pec) as RPEData;\n  const meta = data.META || data;\n  if (!meta?.RPEVersion) throw new Error('Invalid rpe file');\n  const result = { formatVersion: 3, offset: 0, numOfNotes: 0, judgeLineList: [] as JudgeLine[] };\n  const warnings = [] as BetterMessage[];\n  const warn = (code: number, name: string, message: string) => warnings.push({ host: 'RPE2JSON', code, name, message, target: filename });\n  warn(0, 'RPEVersionNotice', `RPE谱面兼容建设中...\\n检测到RPE版本:${meta.RPEVersion}`);\n  const format = `RPE(${meta.RPEVersion})`;\n  // 谱面信息\n  const info: Record<string, string> = {};\n  info.Chart = filename;\n  info.Music = meta.song;\n  info.Image = meta.background;\n  info.Name = meta.name;\n  info.Artist = meta.composer;\n  info.Charter = meta.charter;\n  info.Level = meta.level;\n  result.offset = meta.offset / 1e3;\n  // 判定线贴图(WIP)\n  const line: Record<string, string>[] = [];\n  data.judgeLineList.forEach((i: JudgeLineRPEExtends, index: number) => {\n    i.LineId = index;\n    const texture = String(i.Texture).replace(/\\0/g, '');\n    if (texture === 'line.png') return;\n    const { extended } = i;\n    const scaleX = extended?.scaleXEvents ? extended.scaleXEvents[extended.scaleXEvents.length - 1].end : 1;\n    const scaleY = extended?.scaleYEvents ? extended.scaleYEvents[extended.scaleYEvents.length - 1].end : 1;\n    line.push({\n      Chart: filename,\n      LineId: index.toString(),\n      Image: texture,\n      Scale: scaleY.toString(),\n      Aspect: (scaleX / scaleY).toString(),\n      UseBackgroundDim: '0',\n      UseLineColor: '1',\n      UseLineScale: '1'\n    });\n  });\n  // bpm变速\n  const bpmList = new BpmList(data.BPMList[0].bpm);\n  for (const i of data.BPMList) { i.time = i.startTime[0] + i.startTime[1] / i.startTime[2] }\n  data.BPMList.sort((a: { time: number }, b: { time: number }) => a.time - b.time).forEach((i, idx, arr) => {\n    if (arr[idx + 1]?.time <= 0) return; // 过滤负数\n    bpmList.push(i.time < 0 ? 0 : i.time, arr[idx + 1]?.time ?? 1e9, i.bpm);\n  });\n  for (const i of data.judgeLineList) {\n    if (i.zOrder === undefined) i.zOrder = 0;\n    if (i.bpmfactor === undefined) i.bpmfactor = 1;\n    if (i.father === undefined) i.father = -1;\n    if (i.isCover !== 1) warn(1, 'ImplementionWarning', `未兼容isCover=${i.isCover}(可能无法正常显示)\\n位于${i.LineId}号判定线`);\n    if (i.zOrder !== 0) warn(1, 'ImplementionWarning', `未兼容zOrder=${i.zOrder}(可能无法正常显示)\\n位于${i.LineId}号判定线`);\n    if (i.bpmfactor !== 1) warn(1, 'ImplementionWarning', `未兼容bpmfactor=${i.bpmfactor}(可能无法正常显示)\\n位于${i.LineId}号判定线`);\n    const lineRPE = new LineRPE1(bpmList.baseBpm);\n    lineRPE.setId(i.LineId);\n    if (i.notes) {\n      for (const note of i.notes) {\n        if (note.alpha === undefined) note.alpha = 255;\n        if (note.above !== 1 && note.above !== 2) warn(1, 'NoteSideWarning', `检测到非法方向:${note.above}(将被视为2)\\n位于:\"${JSON.stringify(note)}\"`);\n        if (note.isFake !== 0) warn(1, 'NoteFakeWarning', `检测到FakeNote(可能无法正常显示)\\n位于:\"${JSON.stringify(note)}\"`);\n        if (note.size !== 1) warn(1, 'ImplementionWarning', `未兼容size=${note.size}(可能无法正常显示)\\n位于:\"${JSON.stringify(note)}\"`);\n        if (note.yOffset !== 0) warn(1, 'ImplementionWarning', `未兼容yOffset=${note.yOffset}(可能无法正常显示)\\n位于:\"${JSON.stringify(note)}\"`);\n        if (note.visibleTime !== 999999) warn(1, 'ImplementionWarning', `未兼容visibleTime=${note.visibleTime}(可能无法正常显示)\\n位于:\"${JSON.stringify(note)}\"`);\n        if (note.alpha !== 255 && note.alpha !== 0) warn(1, 'ImplementionWarning', `未兼容alpha=${note.alpha}(可能无法正常显示)\\n位于:\"${JSON.stringify(note)}\"`);\n        const type = [0, 1, 4, 2, 3].indexOf(note.type);\n        const time = bpmList.calc2(note.startTime);\n        const holdTime = bpmList.calc2(note.endTime) - time;\n        const { speed } = note;\n        const positionX = note.positionX / 75.375;\n        lineRPE.pushNote(type, time, positionX, holdTime, speed, note.above === 1, note.isFake !== 0, note.alpha === 0);\n      }\n    }\n    for (const e of i.eventLayers) {\n      if (!e) continue; // 有可能是null\n      const layer = new EventLayer1();\n      for (const j of e.moveXEvents ?? []) {\n        const startTime = bpmList.calc2(j.startTime);\n        const endTime = bpmList.calc2(j.endTime);\n        const { fn, code } = getEasingFn(j, startTime, endTime);\n        getWarning(code, j);\n        layer.pushMoveXEvent(startTime, endTime, j.start, j.end, fn);\n      }\n      for (const j of e.moveYEvents ?? []) {\n        const startTime = bpmList.calc2(j.startTime);\n        const endTime = bpmList.calc2(j.endTime);\n        const { fn, code } = getEasingFn(j, startTime, endTime);\n        getWarning(code, j);\n        layer.pushMoveYEvent(startTime, endTime, j.start, j.end, fn);\n      }\n      for (const j of e.rotateEvents ?? []) {\n        const startTime = bpmList.calc2(j.startTime);\n        const endTime = bpmList.calc2(j.endTime);\n        const { fn, code } = getEasingFn(j, startTime, endTime);\n        getWarning(code, j);\n        layer.pushRotateEvent(startTime, endTime, j.start, j.end, fn);\n      }\n      for (const j of e.alphaEvents ?? []) {\n        const startTime = bpmList.calc2(j.startTime);\n        const endTime = bpmList.calc2(j.endTime);\n        const { fn, code } = getEasingFn(j, startTime, endTime);\n        getWarning(code, j);\n        layer.pushAlphaEvent(startTime, endTime, j.start, j.end, fn);\n      }\n      for (const j of e.speedEvents ?? []) {\n        const startTime = bpmList.calc2(j.startTime);\n        const endTime = bpmList.calc2(j.endTime);\n        layer.pushSpeedEvent(startTime, endTime, j.start, j.end);\n      }\n      lineRPE.eventLayers.push(layer);\n    }\n    i.judgeLineRPE = lineRPE;\n  }\n  for (const i of data.judgeLineList) {\n    const lineRPE = i.judgeLineRPE; // TODO: 待优化\n    const father = data.judgeLineList[i.father];\n    lineRPE.setFather(father?.judgeLineRPE);\n  }\n  for (const i of data.judgeLineList) {\n    const lineRPE = i.judgeLineRPE; // TODO: 待优化\n    const judgeLine = lineRPE.format({ onwarning: (msg: string) => warn(1, 'OtherWarning', `${msg}`) });\n    result.judgeLineList.push(judgeLine);\n    result.numOfNotes += judgeLine.numOfNotes;\n  }\n  return { data: JSON.stringify(result), messages: warnings, info, line, format };\n  function getWarning(code: EasingCode, le: LineEventRPE) {\n    if (code === EasingCode.TypeNotSupported) warn(1, 'EasingTypeWarning', `未知的缓动类型:${le.easingType}(将被视为1)\\n位于:\"${JSON.stringify(le)}\"`);\n    if (code === EasingCode.LeftEqualsRight) warn(1, 'EasingClipWarning', `检测到easingLeft等于easingRight(将被视为线性)\\n位于:\"${JSON.stringify(le)}\"`);\n    if (code === EasingCode.ValueNotFinite) warn(1, 'EasingClipWarning', `非法的缓动函数(将被视为线性)\\n位于:\"${JSON.stringify(le)}\"`);\n  }\n}\n","export function cubicBezier(p1x, p1y, p2x, p2y) {\n  const ZERO_LIMIT = 1e-6;\n  // Calculate the polynomial coefficients,\n  // implicit first and last control points are (0,0) and (1,1).\n  const ax = 3 * p1x - 3 * p2x + 1;\n  const bx = 3 * p2x - 6 * p1x;\n  const cx = 3 * p1x;\n  const ay = 3 * p1y - 3 * p2y + 1;\n  const by = 3 * p2y - 6 * p1y;\n  const cy = 3 * p1y;\n  function sampleCurveDerivativeX(t) {\n    // `ax t^3 + bx t^2 + cx t` expanded using Horner's rule\n    return (3 * ax * t + 2 * bx) * t + cx;\n  }\n  function sampleCurveX(t) {\n    return ((ax * t + bx) * t + cx) * t;\n  }\n  function sampleCurveY(t) {\n    return ((ay * t + by) * t + cy) * t;\n  }\n  // Given an x value, find a parametric value it came from.\n  function solveCurveX(x) {\n    let t2 = x;\n    let derivative, x2;\n    // https://trac.webkit.org/browser/trunk/Source/WebCore/platform/animation\n    // first try a few iterations of Newton's method -- normally very fast.\n    // http://en.wikipedia.org/wikiNewton's_method\n    for (let i = 0; i < 8; i++) {\n      // f(t) - x = 0\n      x2 = sampleCurveX(t2) - x;\n      if (Math.abs(x2) < ZERO_LIMIT) {\n        return t2;\n      }\n      derivative = sampleCurveDerivativeX(t2);\n      // == 0, failure\n      if (Math.abs(derivative) < ZERO_LIMIT) {\n        break;\n      }\n      t2 -= x2 / derivative;\n    }\n    // Fall back to the bisection method for reliability.\n    // bisection\n    // http://en.wikipedia.org/wiki/Bisection_method\n    let t1 = 1;\n    let t0 = 0;\n    t2 = x;\n    while (t1 > t0) {\n      x2 = sampleCurveX(t2) - x;\n      if (Math.abs(x2) < ZERO_LIMIT) {\n        return t2;\n      }\n      if (x2 > 0) {\n        t1 = t2;\n      } else {\n        t0 = t2;\n      }\n      t2 = (t1 + t0) / 2;\n    }\n    // Failure\n    return t2;\n  }\n  function solve(x) {\n    return sampleCurveY(solveCurveX(x));\n  }\n  return solve;\n}\n","import { parse } from './pec2json';\nimport { parse as parseRPE } from './rpe2json';\n// 读取info.txt\nfunction readInfo(text: string): Record<string, string>[] {\n  const lines = String(text).split(/\\r?\\n/);\n  const result = [];\n  let current = {} as Record<string, string>;\n  for (const i of lines) {\n    if (i.startsWith('#')) {\n      if (Object.keys(current).length) result.push(current);\n      current = {};\n    } else {\n      let [key, value] = i.split(/:(.+)/).map(s => s.trim());\n      if (key === 'Song') key = 'Music';\n      if (key === 'Picture') key = 'Image';\n      if (key) current[key] = value;\n    }\n  }\n  if (Object.keys(current).length) result.push(current);\n  return result;\n}\nexport default { parse, parseRPE, readInfo };\n","import Pec from '../extends/pec/index';\nimport { reader } from './reader';\nimport { structChart } from './structChart';\nimport { structInfoData, structLineData } from './structInfo';\nimport md5 from 'md5';\nreader.use({\n  pattern: /\\.(json|pec)$/i,\n  type: 'json',\n  read(i: ByteData, path: string) {\n    const rpeData = Pec.parseRPE(i.text!, i.name/* , path */); // TODO: path\n    const data = structChart(rpeData.data);\n    const info = structInfoData([rpeData.info], path);\n    const line = structLineData(rpeData.line, path);\n    const { messages: msg, format } = rpeData;\n    return { type: 'chart', name: i.name, md5: md5(i.text!), data, msg, info, line, format };\n  }\n});\nreader.use({\n  pattern: /\\.pec$/i,\n  type: 'text',\n  read(i: ByteData) {\n    const pecData = Pec.parse(i.text!, i.name);\n    const data = structChart(pecData.data);\n    const { messages: msg, format } = pecData;\n    return { type: 'chart', name: i.name, md5: md5(i.text!), data, msg, format };\n  }\n});\nreader.use({\n  pattern: /^(Settings|info)\\.txt$/i,\n  type: 'text',\n  mustMatch: true,\n  read(i: ByteData, path: string) {\n    const data = i.text!;\n    const chartInfo = structInfoData(Pec.readInfo(data), path);\n    return { type: 'info' as const, data: chartInfo };\n  }\n});\nif (Object.hasOwn(self, 'webp')) {\n  reader.use({\n    pattern: /\\.webp$/i,\n    type: 'binary',\n    async read(i: ByteData) {\n      const webp2canvas = Object.getOwnPropertyDescriptor(self, 'webp')?.value.default as (buffer: ArrayBuffer) => Promise<HTMLCanvasElement>;\n      const img = await webp2canvas(i.buffer);\n      const bitmap = await createImageBitmap(img);\n      return { type: 'image', name: i.name, data: bitmap };\n    }\n  });\n}\n// fileReader.use({\n//   pattern: /^\\.ogg$/i,\n//   type: 'binary',\n//   async read(i: ByteData) {\n//     const { OggVorbisDecoder } = await import('@wasm-audio-decoders/ogg-vorbis');\n//     const decoder = new OggVorbisDecoder();\n//     await decoder.ready;\n//     const { channelData, samplesDecoded, sampleRate } = await decoder.decodeFile(new Uint8Array(i.buffer));\n//     decoder.free();\n//     const actx = new (window.AudioContext || window.webkitAudioContext)();\n//     const ab = actx.createBuffer(channelData.length, samplesDecoded, sampleRate);\n//     channelData.forEach((channel, idx) => ab.getChannelData(idx).set(channel));\n//     return { type: 'audio', name: i.name, data: { audio: ab, video: null } };\n//   }\n// });\n","import { isLinear } from './easing.js';\nimport { BpmList } from './BpmList';\nimport { LinePec } from './LinePec';\ninterface BpmCommand {\n  time: number;\n  bpm: number;\n}\ninterface NoteCommand {\n  type: number;\n  lineId: number;\n  time: number;\n  time2: number;\n  offsetX: number;\n  isAbove: number;\n  isFake: number;\n  text: string;\n  speed: number;\n  size: number;\n}\ninterface LineCommand {\n  type: string;\n  lineId: number;\n  time: number;\n  time2: number;\n  speed: number;\n  offsetX: number;\n  offsetY: number;\n  rotation: number;\n  alpha: number;\n  motionType: number;\n  text: string;\n}\ninterface PecParseResult {\n  data: string;\n  messages: string[];\n  format: string;\n}\nexport function parse(pec: string, filename: string): PecParseResult {\n  const data = pec.split(/\\s+/); // 切分pec文本\n  const data2 = {\n    offset: 0,\n    bpmList: [] as BpmCommand[],\n    notes: [] as NoteCommand[],\n    lines: [] as LineCommand[]\n  };\n  const result = {\n    formatVersion: 3,\n    offset: 0,\n    numOfNotes: 0,\n    judgeLineList: [] as JudgeLine[]\n  };\n  const warnings = []; //\n  let ptr = 0;\n  data2.offset = isNaN(Number(data[ptr])) ? 0 : Number(data[ptr++]);\n  while (ptr < data.length) {\n    const command = data[ptr++];\n    if (command === '') { continue }\n    if (command === 'bp') {\n      const time = Number(data[ptr++]);\n      const bpm = Number(data[ptr++]);\n      data2.bpmList.push({ time, bpm });\n    } else if (command.startsWith('n')) {\n      if (!'1234'.includes(command[1])) { throw new Error(`Unsupported Command: ${command}`) }\n      const cmd = {} as NoteCommand;\n      const type = command[1];\n      cmd.type = Number(type);\n      cmd.lineId = Number(data[ptr++]);\n      cmd.time = Number(data[ptr++]);\n      cmd.time2 = '2'.includes(type) ? Number(data[ptr++]) : cmd.time;\n      cmd.offsetX = Number(data[ptr++]);\n      cmd.isAbove = Number(data[ptr++]);\n      cmd.isFake = Number(data[ptr++]);\n      cmd.text = `n${Object.values(cmd).join(' ')}`;\n      cmd.speed = (data[ptr++] || '').startsWith('#') ? Number(data[ptr++]) : (ptr--, 1);\n      cmd.size = (data[ptr++] || '').startsWith('&') ? Number(data[ptr++]) : (ptr--, 1);\n      data2.notes.push(cmd);\n    } else if (command.startsWith('c')) {\n      if (!'vpdamrf'.includes(command[1])) { throw new Error(`Unsupported Command: ${command}`) }\n      const cmd = {} as LineCommand;\n      const type = command[1];\n      cmd.type = type;\n      cmd.lineId = Number(data[ptr++]);\n      cmd.time = Number(data[ptr++]);\n      if ('v'.includes(type)) { cmd.speed = Number(data[ptr++]) }\n      cmd.time2 = 'mrf'.includes(type) ? Number(data[ptr++]) : cmd.time;\n      if ('pm'.includes(type)) { cmd.offsetX = Number(data[ptr++]) }\n      if ('pm'.includes(type)) { cmd.offsetY = Number(data[ptr++]) }\n      if ('dr'.includes(type)) { cmd.rotation = Number(data[ptr++]) }\n      if ('af'.includes(type)) { cmd.alpha = Number(data[ptr++]) }\n      if ('mr'.includes(type)) { cmd.motionType = Number(data[ptr++]) }\n      cmd.text = `c${Object.values(cmd).join(' ')}`;\n      if ('pdaf'.includes(type)) { cmd.motionType = 1 }\n      data2.lines.push(cmd);\n    } else { throw new Error(`Unexpected Command: ${command}`) }\n  }\n  result.offset = data2.offset / 1e3 - 0.175; // v18x固定延迟\n  // bpm变速\n  if (!data2.bpmList.length) { throw new Error('Invalid pec file') }\n  const bpmList = new BpmList(data2.bpmList[0].bpm); // FIXME: 考虑合适的bpm范围\n  data2.bpmList.sort((a, b) => a.time - b.time).forEach((i, idx, arr) => {\n    if (arr[idx + 1]?.time <= 0) { return } // 过滤负数\n    bpmList.push(i.time < 0 ? 0 : i.time, arr[idx + 1]?.time ?? 1e9, i.bpm);\n  });\n  // note和判定线事件\n  const linesPec = [] as LinePec[];\n  for (const i of data2.notes) {\n    const type = [0, 1, 4, 2, 3].indexOf(i.type);\n    const time = bpmList.calc(i.time);\n    const holdTime = bpmList.calc(i.time2) - time;\n    const speed = isNaN(i.speed) ? 1 : i.speed;\n    linesPec[i.lineId] ??= new LinePec(bpmList.baseBpm);\n    linesPec[i.lineId].pushNote(type, time, i.offsetX / 115.2, holdTime, speed, i.isAbove === 1, i.isFake !== 0); // 102.4\n    // if (i.isAbove !== 1 && i.isAbove !== 2) warnings.push(`检测到非法方向:${i.isAbove}(将被视为2)\\n位于:\"${i.text}\"\\n来自${filename}`);\n    if (i.isFake !== 0) warnings.push(`检测到FakeNote(可能无法正常显示)\\n位于:\"${i.text}\"\\n来自${filename}`);\n    if (i.size !== 1) warnings.push(`检测到异常Note(可能无法正常显示)\\n位于:\"${i.text}\"\\n来自${filename}`);\n  }\n  const isMotion = (i: number) => !isLinear(i) || i === 1;\n  for (const i of data2.lines) {\n    const t1 = bpmList.calc(i.time);\n    const t2 = bpmList.calc(i.time2);\n    if (t1 > t2) {\n      warnings.push(`检测到开始时间大于结束时间(将禁用此事件)\\n位于:\"${i.text}\"\\n来自${filename}`);\n      continue;\n    }\n    linesPec[i.lineId] ??= new LinePec(bpmList.baseBpm);\n    // 变速\n    if (i.type === 'v') {\n      linesPec[i.lineId].pushSpeedEvent(t1, i.speed / 7.0); // 6.0??\n    }\n    // 不透明度\n    if (i.type === 'a' || i.type === 'f') {\n      linesPec[i.lineId].pushAlphaEvent(t1, t2, Math.max(i.alpha / 255, 0), i.motionType); // 暂不支持alpha值扩展\n      if (i.alpha < 0) { warnings.push(`检测到负数Alpha:${i.alpha}(将被视为0)\\n位于:\"${i.text}\"\\n来自${filename}`) }\n    }\n    // 移动\n    if (i.type === 'p' || i.type === 'm') {\n      linesPec[i.lineId].pushMoveEvent(t1, t2, i.offsetX / 2048, i.offsetY / 1400, isMotion(i.motionType) ? i.motionType : 1);\n      if (!isMotion(i.motionType)) { warnings.push(`未知的缓动类型:${i.motionType}(将被视为1)\\n位于:\"${i.text}\"\\n来自${filename}`) }\n    }\n    // 旋转\n    if (i.type === 'd' || i.type === 'r') {\n      linesPec[i.lineId].pushRotateEvent(t1, t2, -i.rotation, isMotion(i.motionType) ? i.motionType : 1);\n      if (!isMotion(i.motionType)) { warnings.push(`未知的缓动类型:${i.motionType}(将被视为1)\\n位于:\"${i.text}\"\\n来自${filename}`) }\n    }\n  }\n  for (const i of linesPec) {\n    const judgeLine = i.format();\n    result.judgeLineList.push(judgeLine);\n    result.numOfNotes += judgeLine.numOfNotes;\n  }\n  return { data: JSON.stringify(result), messages: warnings, format: 'PEC' };\n}\n"],"names":["tl","t","Math","sin","PI","cos","sqrt","easing","index","trunc","BpmList","constructor","baseBpm","__publicField","this","Number","accTime","list","push","start","end","bpm","value","calc","beat","time","i","round","calc2","LinePec","speedEvents","notes","alphaEvents","moveEvents","rotateEvents","isNaN","pushNote","type","positionX","holdTime","speed","isAbove","isFake","pushSpeedEvent","pushAlphaEvent","startTime","endTime","motionType","pushMoveEvent","value2","pushRotateEvent","format","sortFn","a","b","sortFn2","s","result","formatVersion","offset","numOfNotes","numOfNotesAbove","numOfNotesBelow","notesAbove","notesBelow","judgeLineDisappearEvents","judgeLineMoveEvents","judgeLineRotateEvents","pushDisappearEvent","r","start2","end2","c","m","cvp","sort","s1","length","max","floorPosition","fround","v1","v2","v3","e","note","dt","d1","easingFn","t1","x1","x2","mt","m1","m2","t2","rt","r1","getEasingFn","le","bezier","floor","code","bezierPoints","p1x","p1y","p2x","p2y","eSpeed","e1Delta","ax","bx","cx","ay","by","cy","sampleCurveDerivativeX","sampleCurveX","solve","x","sampleCurveY","derivative","abs","t0","solveCurveX","cubicBezier","fn","bezierFn","easingType","easingLeft","easingRight","eHead","eTail","isFinite","clipFn","pushLineEvent","ls","delta","j","getEventsValue","d","_ref2","_a","getMoveValue","_ref3","_ref4","result2","_b","getRotateValue","_ref5","combineMultiEvents","es","splits","reduce","n","EventLayer1","moveXEvents","moveYEvents","pushMoveXEvent","pushMoveYEvent","LineRPE1","eventLayers","father","settled","merged","isHide","isHidden","setId","id","NaN","setFather","fatherLine","preset","events","map","xe","ye","startX","endX","startY","endY","combineXYEvents","toSpeedEvent","fitFather","stack","onwarning","console","warn","includes","concat","join","child","fatherX","fatherY","fatherR","fatherX2","fatherY2","fatherR2","childX","childY","childX2","childY2","mergeFather","floorPos","minPos","floorPositionMin","min","getPositionValues","vmin","v4","getHoldSpeedValue","p","speedFactor","Pec","text","lines","String","split","current","startsWith","Object","keys","key","trim","reader","use","pattern","read","path","rpeData","pec","filename","data","JSON","parse","meta","META","RPEVersion","Error","judgeLineList","warnings","name","message","host","target","info","Chart","Music","song","Image","background","Name","Artist","composer","Charter","charter","Level","level","line","forEach","LineId","texture","Texture","replace","extended","scaleX","scaleXEvents","scaleY","scaleYEvents","toString","Scale","Aspect","UseBackgroundDim","UseLineColor","UseLineScale","bpmList","BPMList","idx","arr","_ref6","zOrder","bpmfactor","isCover","lineRPE","alpha","above","stringify","size","yOffset","visibleTime","indexOf","layer","_f$moveXEvents","getWarning","_f$moveYEvents","_f$rotateEvents","_f$alphaEvents","_f$speedEvents","judgeLineRPE","judgeLine","msg","messages","structChart","structInfoData","structLineData","md5","pecData","data2","ptr","command","cmd","lineId","time2","offsetX","values","offsetY","rotation","_ref","linesPec","_p$l","isMotion","isLinear","_p$E","mustMatch","hasOwn","self","img","getOwnPropertyDescriptor","default","buffer","bitmap","createImageBitmap"],"mappings":"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"}